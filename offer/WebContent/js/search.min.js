$(function(){$(window).resize(function(){var a=$("#search_box").offset().left;$(".ui-autocomplete").css("left",a)}),$(".ui-autocomplete").css("height","200px"),$.widget("custom.catcomplete",$.ui.autocomplete,{_renderItem:function(a,b){var c=b.count>=600?"大于":"共";return $("<li></li>").data("item.autocomplete",b).append("<a><span class='fl'>"+b.name+"</span><span class='fr'>"+c+"<i>"+b.count+"个</i>职位</span></a>").appendTo(a)},_renderMenu:function(a,b){var c=this,d="";$.each(b,function(b,e){e.category!=d&&(a.append("<li class='ui-autocomplete-category'>"+e.category+"</li>"),d=e.category),c._renderItemData(a,e)}),a.find(".ui-autocomplete-category:not(:first-child)").next().css("borderTop","1px dashed #e5e5e5"),a.find(".ui-autocomplete-category").first().css("borderTop","none")}}),$("#search_input").catcomplete({minLength:0,source:function(a,b){""!=$.trim(a.term)?$.ajax({url:ctx+"/suggest.json",dataType:"json",data:{query:a.term},success:function(a){var f,c=new Array,d="",e=["职位","公司","城市"];for(f=0;f<a.content.length;f++)$.each(a.content[f],function(a,b){d='{"name":"'+b.name+'","count":"'+b.count+'","type":"'+b.type+'","category":"'+e[f]+'"}',d=jQuery.parseJSON(d),c.push(d)});b(c)}}):b("")},focus:function(){return!1},select:function(a,b){return $("#search_input").val(b.item.name),$("#searchForm").attr("action",ctx+"/jobs/list_"+b.item.name),$("#search_button").trigger("click",b.item.type),!1}}),$("#search_button").click(function(a,b){var c,d,e,f,g;b?$("#spcInput").val(b):$("#spcInput").val(""),c=$.trim($("#search_input").val()),d=/[`~!@\$%\^\&\*\(\)_<>\?:"\{\},\\\/;'\[\]]/g,e=/#/g,f=/\./g,g=c.replace(d," "),""==g?$("#searchForm").attr("action",ctx+"/jobs/list_所有职位").submit():(g=g.replace(e,"井"),g=g.replace(f,"。"),$("#searchForm").attr("action",ctx+"/jobs/list_"+g).submit())})});